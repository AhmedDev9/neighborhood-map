var yelpKeyData={consumerKey:"F5APQyb0l7Em1n9zaVUNsQ",consumerSecret:"3dYrzpG46RBg4uk_uLuHyUwi1rI",token:"EsMVBbm6XcJsvvAjbqPec7Fm6oibxnK9",tokenSecret:"cZ57WmK7BvKmk-Irq6dFanfnqjA"},locationData=[{name:"Toshi Sushi",yelpID:"toshi-sushi-los-angeles-2",address:"359 E 1st St Los Angeles, CA 90012",location:{lat:34.0496,lng:-118.239411}},{name:"Mr Ramen",yelpID:"mr-ramen-los-angeles",address:"341 E 1st St Los Angeles, CA 90012",location:{lat:34.049768,lng:-118.239631}},{name:"Sushi Enya",yelpID:"sushi-enya-los-angeles",address:"343 E 1st St Los Angeles, CA 90012",location:{lat:34.049763,lng:-118.239568}},{name:"Suehiro Cafe",yelpID:"suehiro-cafe-los-angeles",address:"337 E 1st St Los Angeles, CA 90012",location:{lat:34.04989,lng:-118.23975}},{name:"Monzo",yelpID:"marugame-monzo-los-angeles-2",address:"329 E 1st St Los Angeles, CA 90012",location:{lat:34.050031,lng:-118.239965}},{name:"Daikokuya",yelpID:"daikokuya-los-angeles",address:"327 E 1st St Los Angeles, CA 90012",location:{lat:34.05007,lng:-118.24002}},{name:"Korea BBQ House",yelpID:"korean-bbq-house-los-angeles",address:"323 E 1st St Los Angeles, CA 90012",location:{lat:34.050108,lng:-118.240107}},{name:"Manichi Ramen",yelpID:"manichi-ramen-los-angeles",address:"321 1/2 E 1st St Los Angeles, CA 90012",location:{lat:34.050144,lng:-118.240135}},{name:"Sansuitei",yelpID:"san-sui-tei-los-angeles",address:"313 E 1st St Los Angeles, CA 90012",location:{lat:34.050297,lng:-118.240397}},{name:"JiST cafe",yelpID:"jist-cafe-los-angeles",address:"116 Judge John Aiso St Los Angeles, CA 90012",location:{lat:34.050771,lng:-118.240376}}],MapViewModel=function(){var e=this;e.yelpRequest=function(n,o){var a=function(){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;20>o;o++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},t="http://api.yelp.com/v2/business/"+n,s={oauth_consumer_key:yelpKeyData.consumerKey,oauth_token:yelpKeyData.token,oauth_nonce:a(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb"},i=oauthSignature.generate("GET",t,s,yelpKeyData.consumerSecret,yelpKeyData.tokenSecret);s.oauth_signature=i;var l={url:t,data:s,cache:!0,dataType:"jsonp",timeout:7e3,success:function(n,a,t){e.jsonGET(n,o)},error:function(){console.log("There is an error getting Yelp information")}};$.ajax(l)},e.center=new google.maps.LatLng(34.050275,-118.239985),e.init=function(){var n={disableDefaultUI:!0,zoom:19,center:e.center};e.map=new google.maps.Map(document.getElementById("map-canvas"),n),e.markers=ko.observableArray([]),$.each(locationData,function(n,o){var a=new google.maps.Marker({position:new google.maps.LatLng(o.location.lat,o.location.lng),map:e.map,listVisible:ko.observable(!0),animation:google.maps.Animation.DROP,name:o.name,address:o.address});e.yelpRequest(o.yelpID,a);var t="<div><h1>"+o.name+"</h1><p>"+o.address+"</p></div>";e.infowindow=new google.maps.InfoWindow,google.maps.event.addListener(a,"click",function(){e.map.panTo(a.getPosition()),a.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.setAnimation(null)},750),e.infowindow.setContent(t),e.infowindow.open(e.map,this)}),e.markers.push(a)}),google.maps.event.addListener(e.infowindow,"closeclick",function(){e.resetCenter()})},e.setCurrentRestuarant=function(e){google.maps.event.trigger(e,"click")},e.jsonGET=function(n,o){var a="<div><h1>"+o.name+"</h1><p>"+o.address+"</p><p> Rating: "+n.rating+" | # of Reviews: "+n.review_count+'</p><img src="'+n.rating_img_url+'"></img></div>';e.infowindow=new google.maps.InfoWindow,google.maps.event.addListener(o,"click",function(){e.infowindow.setContent(a),e.infowindow.open(e.map,this)})},e.resetCenter=function(){e.map.panTo(e.center)},e.locationListIsOpen=ko.observable(!0),e.toggleLocationListIsOpen=function(){e.locationListIsOpen(!e.locationListIsOpen())},e.toggleLocationListIsOpenButtonText=ko.computed(function(){return e.locationListIsOpen()?"hide":"show"}),e.toggleLocationListIsOpenStatus=ko.computed(function(){return e.locationListIsOpen()?!0:!1}),e.filterWord=ko.observable(""),e.filterWordSearch=ko.computed(function(){return e.filterWord().toLowerCase().split(" ")}),e.filterSubmit=function(){e.filterWordSearch().forEach(function(n){e.markers().forEach(function(o){var a=o.name.toLowerCase(),t=o.address.toLowerCase();o.setMap(-1===a.indexOf(n)&&-1===t.indexOf(n)?null:e.map),o.listVisible(-1===a.indexOf(n)&&-1===t.indexOf(n)?!1:!0)})}),e.filterWord("")},e.init()};$(ko.applyBindings(new MapViewModel));